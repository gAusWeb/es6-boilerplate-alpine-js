import e from"dayjs";let currentRange,weekday=require("dayjs/plugin/weekday"),weekOfYear=require("dayjs/plugin/weekOfYear");var isBetween=require("dayjs/plugin/isBetween");e.extend(weekday),e.extend(weekOfYear),e.extend(isBetween),$(document).ready(function(){var t,a,n;let r=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];e().subtract(1,"month").format("YYYY-MM-DD");let d=e().subtract(1,"month").format("YYYY-MM"),o=e().add(11,"month").format("YYYY-MM"),l=parseInt(e().format("YY")),s=parseInt(e().subtract(1,"month").format("MM")),c=parseInt(e().add(11,"month").format("YY")),i=parseInt(e().add(11,"month").format("MM")),m=parseInt(e().add(11,"month").format("YYYY")),u=parseInt(e().add(11,"month").format("M")),Y=e().format("YYYY"),f=e().format("M"),h={start:d,end:o},y={startYear:l,startMonth:s,endYear:c,endMonth:i},M=e(new Date(Y,f-1)),p,_,g,w=[{month:9,events:[{day:7,drawType:1},{day:3,drawType:2},{day:19,drawType:3}]},{month:10,events:[{day:4,drawType:1},{day:11,drawType:1},{day:17,drawType:2},{day:30,drawType:3}]}],R=document.getElementById("calendar-wrapper-custom"),v=document.createElement("button"),b=document.createElement("button");function E(t=Y,a=f,n=1){R.innerHTML="";let d=document.createElement("section");d.classList.add("calendar-month-header");for(let o=0;o<n;o++){let l=document.createElement("div");l.classList.add("calendar-months-wrapper");let s=document.createElement("div"),c=document.createElement("div"),i=document.createElement("div"),m=document.createElement("ol"),u=document.createElement("ol");s.classList.add("calendar-month"),c.classList.add("calendar-month-header-selected-month"),c.setAttribute("id","selected-month"),i.classList.add("calendar-month-header-selectors"),m.classList.add("day-of-week"),m.setAttribute("id","days-of-week"),u.classList.add("days-grid"),u.setAttribute("id","calendar-days");let h=document.getElementById("calendar-days");c.innerText=e(new Date(t,a-1+o)).format("MMMM YYYY"),i.appendChild(c),s.appendChild(i),l.appendChild(c),r.forEach(e=>{let t=document.createElement("li");m.appendChild(t),t.innerText=e}),R.appendChild(l),l.appendChild(m),l.appendChild(u),p=k(t,parseInt(a)+o,e(`${t}-${a}-01`).daysInMonth()),_=L(t,a),g=A(t,a);let y=[..._,...p,...g],E,T=w.filter(t=>t.month==e(M).add(o,"month").format("M")&&t.events);if(T.length>0){let x=T.map(e=>e.events);E=x.flat()}y.forEach((e,t)=>{E&&E.length>0&&E.forEach((t,a)=>{if(e.dayOfMonth==t.day){C(e,h,!0,t.drawType,l);return}}),C(e,h,void 0,void 0,l)})}R.appendChild(v),R.appendChild(b)}function C(e,t,a=!1,n=null,r){let d=document.createElement("li"),o=d.classList;if(o.add("calendar-day"),a){switch(n){case 3:o.add("draw-type-3");break;case 2:o.add("draw-type-2");break;default:o.add("draw-type-1")}o.add("draw-day")}else{let l=document.createElement("span");l.innerText=e.dayOfMonth,d.appendChild(l)}e.isCurrentMonth||o.add("calendar-day--not-current"),r.querySelector(".days-grid").appendChild(d)}function T(e){let t=e.firstElementChild;for(;t;)t.remove(),t=e.firstElementChild}function k(t,a){var n,r;return[...Array((n=t,e(`${n}-${r=a}-01`).daysInMonth()))].map((n,r)=>({date:e(`${t}-${a}-${r+1}`).format("YYYY-MM-DD"),dayOfMonth:r+1,isCurrentMonth:!0}))}function L(t,a){let n=x(p[0].date),r=e(`${t}-${a}-01`).subtract(1,"month"),d=n?n-1:6,o=e(p[0].date).subtract(d,"day").date();return[...Array(d)].map((t,a)=>({date:e(`${r.year()}-${r.month()+1}-${o+a}`).format("YYYY-MM-DD"),dayOfMonth:o+a,isCurrentMonth:!1}))}function A(t,a){let n=x(`${t}-${a}-${p.length}`),r=e(`${t}-${a}-01`).add(1,"month");return[...Array(n?7-n:n)].map((t,a)=>({date:e(`${r.year()}-${r.month()+1}-${a+1}`).format("YYYY-MM-DD"),dayOfMonth:a+1,isCurrentMonth:!1}))}function x(t){return e(t).weekday()}function D(t=null){let a="prev"===t?-1*Math.abs(currentRange):currentRange;return e(M).add(a,"month").format("YYYY-MM")}function O(){return e(M).add(currentRange+currentRange-1,"month")}v.setAttribute("id","previous-month-selector"),b.setAttribute("id","next-month-selector"),v.classList.add("calendar-selectors"),b.setAttribute("id","next-month-selector"),b.classList.add("calendar-selectors"),v.innerText="<",b.innerText=">";let B=t=>{$(b).attr("style")&&$(b).removeAttr("style"),function t(a=null){return D(a)!=h.start&&e(D(a)).isBetween(h.start,h.end,null,"[]")}("prev")?M=e(M).subtract(currentRange,"month"):($(v).css("display","none"),M=e(M).subtract(function e(){let t=parseInt(M.format("M"))-y.startMonth;return t}(),"month")),E(M.format("YYYY"),M.format("M"),currentRange)},j=t=>{if($(v).attr("style")&&$(v).removeAttr("style"),parseInt(O().format("YY"))===y.endYear&&parseInt(O().format("MM"))>=y.endMonth?1:0){let a;M=e(M).add((a=0,parseInt(O().format("M"))==y.endMonth&&(a=currentRange),parseInt(O().format("M"))>y.endMonth&&(a=currentRange-(parseInt(O().format("M"))-y.endMonth)),a),"month"),$(b).css("display","none")}else M=e(M).add(currentRange,"month");E(M.format("YYYY"),M.format("M"),currentRange)},I=()=>{switch(!0){case window.innerWidth<768:if(1===currentRange)return;M.format("YYYY")==m&&parseInt(M.format("M"))<u&&$(b).removeAttr("style"),currentRange=1,E(M.format("YYYY"),M.format("M"),currentRange);break;case window.innerWidth>=768&&window.innerWidth<1024:if(2===currentRange)return;if(currentRange=2,E(M.format("YYYY"),M.format("M"),currentRange),M.format("YYYY")==m){let t=e(M).add(currentRange,"month");t.format("M")>u?$(b).css("display","none"):$(b).removeAttr("style")}break;default:if(3===currentRange)return;if(M.format("YYYY")==m&&parseInt(M.format("M"))+currentRange>u&&(M=e(M).subtract(1,"month"),$(b).removeAttr("style"),console.log()),currentRange=3,M.format("YYYY")==m&&parseInt(M.format("M"))+currentRange>u){b.style.display="none";let a=currentRange-(parseInt(M.format("M"))+currentRange-u);if(parseInt(M.format("M"))+currentRange-1==u){E(M.format("YYYY"),M.format("M"),currentRange);return}M=e(M).subtract(a,"month")}E(M.format("YYYY"),M.format("M"),currentRange)}};I(),v.addEventListener("click",B),b.addEventListener("click",j);let W=(t=I,function(){var e=this,r=arguments,d=function(){n=null,a||t.apply(e,r)},o=a&&!n;clearTimeout(n),n=setTimeout(d,100),o&&t.apply(e,r)});$(window).resize(W)});